  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UN Cargador</title>
  <style>
    body {
        background-size: 80%;
        background-position: center;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
    }
    .background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .dot {
      position: absolute;
      width: 4px;
      height: 4px;
      background-color: greenyellow;
      border-radius: 50%;
    }
    .content {
      position: relative;
      z-index: 1;
    }
    .header{
        background-size: 50% auto;
        background-repeat: no-repeat;
        position: relative;
        top: 10px;
        left: 100px;
       
        width: 1000px;
        height: 80px;
        text-align: center;
        padding: 50px;
        color: darkgreen;
    }
    .header h1 {
        color: #000044;
        font-size: 50px;
        font-family: ui-serif;
        margin: 0;
        padding:0 200px;;
    }
    .container {
        background-position: center;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .container1 {
        background-image: white;
        background-size: cover;
        background-position: center;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .overlay {
        background-color: rgba(255, 255, 255, 0.7);
        padding: 20px;
        border-radius: 10px;
        max-width: 400px;
    }
    .overlay h2 {
        font-size: 12px;
    }

    .container3 {
        background-color: rgba(255, 255, 255, 0.8);
        border: 1px solid #ccc;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        display: flex;
        grid-gap: 20px;
        max-width: 900px;
        font-size: large;
    }

    .circle {
        width: 220px;
        height: 220px;
        border: 2px solid black;
        border-radius: 50%;
        background-size: cover;
        background-position: center;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    .circle-text {
        margin-top: 20px;
    }

    .battery-container {
        position: relative;
        width: 200px;
        height: 400px;
        background-color: #000;
        border: 2px solid #00ff00;
        overflow: hidden;
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
    }

    .battery-level {
        width: 100%;
        position: absolute;
        bottom: 0;
        left: 0;
        transform-origin: bottom;
        animation-duration: 2s;
        animation-iteration-count: infinite;
        animation-timing-function: linear;
        animation-name: chargeAnimation;
        background-image: linear-gradient(to top, #00ff00, #000);
    }

    @keyframes chargeAnimation {
      0% {
        height: 0%;
      }
      100% {
        height: var(--battery-level);
      }
    }

    .battery-level::before {
        content: '';
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        width: 10px;
        height: 20px;
        background-color: #00ff00;
        border-radius: 50%;
        box-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
        animation-duration: 2s;
        animation-iteration-count: infinite;
        animation-timing-function: ease-in-out;
        animation-name: pulseAnimation;
    }

    @keyframes pulseAnimation {
      0% {
        transform: translateX(-50%) scale(1);
        opacity: 1;
      }
      50% {
        transform: translateX(-50%) scale(1.2);
        opacity: 0.8;
      }
      100% {
        transform: translateX(-50%) scale(1);
        opacity: 1;
      }
    }

    .battery-text {
        color: #fff;
        font-size: 24px;
        text-align: center;
        margin-top: 10px;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
    }
    #Boton {

        position: absolute;
        top: 580px;
        left: 45%;

         
        width: 200px;
        height: 50px;

             
        border-radius: 10px;

             
        background-color: #424242;
        color: white;
        font-size: 16px;
        font-weight: bold;
    }

    #Boton3 {

        position: absolute;
        top: 580px;
        left: 80%;

         
        width: 200px;
        height: 50px;

             
        border-radius: 10px;

             
        background-color: #FFFFF;
        color: black;
        font-size: 16px;
        font-weight: bold;
    }


    form input[type="text"],
    form select {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        box-sizing: border-box;
    }
        
   
    form input[type="file"]::-webkit-file-upload-button {
        background-color: #444;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px; 
    }
        
    form input[type="file"]::-webkit-file-upload-button:hover {
        background-color: #555;
    }
    
    form input[type="submit"] {
        width: 100%;
        padding: 10px;
        background-color: #333;
        color: #fff;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        font-size: 14px; 
    }
        
    form input[type="submit"]:hover {
        background-color: #555;
    }

  </style>
  </head>
  <body>
    <div class="background"></div>
    <div class="content">
      <div id="inicio">
        <div class="header">
          <h1>UN Cargador</h1>
        </div>
      </div>
    </div>

    <button id="Boton" onclick="redireccionar1()">Crear perfil nuevo</button>

    <script>
      // Generar puntos aleatorios en el fondo
      var numDots = 500;
      var container = document.querySelector('.background');

      for (var i = 0; i < numDots; i++) {
        var dot = document.createElement('div');
        dot.classList.add('dot');
        dot.style.top = Math.random() * 100 + '%';
        dot.style.left = Math.random() * 100 + '%';
        container.appendChild(dot);
      }
        //Cambio página de cración de perfil 
    function redireccionar1() {
      var contenidoDiv = document.getElementById("inicio");
      contenidoDiv.innerHTML = "";

      var nuevoContenido = document.createElement("div");
      nuevoContenido.innerHTML = `
        <div id="crear">
          <div class="container">
            <div class="overlay">
              <h1>Bienvenido/a</h1>
              <form action="/enviar_variables" method="POST">
                <input id="nombre5" type="text" placeholder="Nombre">
                <select id="vehiculo">
                  <option value="">Selecciona un vehículo</option>
                  <option value="Tesla Model S">Tesla Model S</option>
                  <option value="Tesla Model 3">Tesla Model 3</option>
                  <option value="Tesla Model X">Tesla Model X</option>
                  <option value="Tesla Model Y">Tesla Model Y</option>
                  <option value="Audi e-tron GT">Audi e-tron GT</option>
                  <option value="Chevrolet Bolt EUV">Chevrolet Bolt EUV</option>
                  <option value="Porsche Taycan Turbo S">Porsche Taycan Turbo S</option>
                  <option value="Lucid Air">Lucid Air</option>
                  <option value="Ford Mustang Mach-E">Ford Mustang Mach-E</option>
                  <option value="Rivian R1T">Rivian R1T</option>
                  <option value="Jaguar I-Pace">Jaguar I-Pace</option>
                  <option value="Volkswagen ID.4">Volkswagen ID.4</option>
                  <option value="Hyundai Ioniq 5">Hyundai Ioniq 5</option>
                  <option value="Kia EV6">Kia EV6</option>
                  <option value="Nissan Ariya">Nissan Ariya</option>
                  <option value="Mini Cooper SE">Mini Cooper SE</option>
                  <option value="BMW i4">BMW i4</option>
                  <option value="Mercedes-Benz EQS">Mercedes-Benz EQS</option>
                  <option value="Polestar2">Polestar 2</option>
                  <option value="Volvo XC40 Recharge">Volvo XC40 Recharge</option>
                </select>
                <h2>Inserte foto de perfil</h2>
                <input id="fotop" type="file" accept=".jpg, .jpeg">
                <h1></h1>
                <input type="submit" value="Enviar" onclick="redireccionar2()">
              </form>
            </div>
          </div>
        </div>
      `;

      contenidoDiv.appendChild(nuevoContenido);

      var boton = document.getElementsByTagName("button")[0];
      boton.style.display = "none";
    }




    function redireccionar2() {
      var auto = document.getElementById("vehiculo").value;
      var nombre = document.getElementById("nombre5").value;
      var foto = document.getElementById("fotop").files;

      var contenidoDiv2 = document.getElementById("crear");
      contenidoDiv2.innerHTML = "";

      var nuevoContenido2 = document.createElement("div");

      nuevoContenido2.innerHTML = `
        <body>
          <div id="porcentaje">
            <div class="container1">
              <div class="overlay">
                ${
                  foto.length > 0
                    ? `<div class="circle" style="background-image: url(${URL.createObjectURL(
                        foto[0]
                      )});"></div>`
                    : `<div class="circle"></div>`
                }
                <h1>${nombre}</h1>
                <h2 id="carro">${auto}</h2>
                <form>
                  <input id="porc" type="text" placeholder="Ingrese % actual de carga">
                  <h1 id="nombre1"></h1>
                  <input type="submit" value="Continuar" onclick="redireccionar3()">
                </form>
              </div>
            </div>
          </div>
        </body>
      `;

      contenidoDiv2.appendChild(nuevoContenido2);
    }

    function redireccionar3() {
      var autonomiaM;
      var cBateria;
      var opcionSeleccionada = document.getElementById("carro").innerHTML;

      if (opcionSeleccionada === "Tesla Model S") {
        autonomiaM = 627;
        cBateria = 100;
      } else if (opcionSeleccionada === "Tesla Model 3") {
        autonomiaM = 614;
        cBateria = 82;
      } else if (opcionSeleccionada === "Tesla Model X") {
        autonomiaM = 579;
        cBateria = 100;
      } else if (opcionSeleccionada === "Tesla Model Y") {
        autonomiaM = 500;
        cBateria = 70;
      } else if (opcionSeleccionada === "Audi e-tron GT") {
        autonomiaM = 400;
        cBateria = 95;
      } else if (opcionSeleccionada === "Chevrolet Bolt EUV") {
        autonomiaM = 350;
        cBateria = 65;
      } else if (opcionSeleccionada === "Porsche Taycan Turbo S") {
        autonomiaM = 375;
        cBateria = 83.7;
      } else if (opcionSeleccionada === "Lucid Air") {
        autonomiaM = 520;
        cBateria = 113;
      } else if (opcionSeleccionada === "Ford Mustang Mach-E") {
        autonomiaM = 305;
        cBateria = 68;
      } else if (opcionSeleccionada === "Rivian R1T") {
        autonomiaM = 314;
        cBateria = 105;
      } else if (opcionSeleccionada === "Jaguar I-Pace") {
        autonomiaM = 292;
        cBateria = 90;
      } else if (opcionSeleccionada === "Volkswagen ID.4") {
        autonomiaM = 250;
        cBateria = 82;
      } else if (opcionSeleccionada === "Hyundai Ioniq 5") {
        autonomiaM = 300;
        cBateria = 72.6;
      } else if (opcionSeleccionada === "Kia EV6") {
        autonomiaM = 300;
        cBateria = 77.4;
      } else if (opcionSeleccionada === "Nissan Ariya") {
        autonomiaM = 223;
        cBateria = 65;
      } else if (opcionSeleccionada === "Mini Cooper SE") {
        autonomiaM = 180;
        cBateria = 32.6;
      } else if (opcionSeleccionada === "BMW i4") {
        autonomiaM = 300;
        cBateria = 81.5;
      } else if (opcionSeleccionada === "Mercedes-Benz EQS") {
        autonomiaM = 478;
        cBateria = 107.8;
      } else if (opcionSeleccionada === "Polestar 2") {
        autonomiaM = 275;
        cBateria = 78;
      } else if (opcionSeleccionada === "Volvo XC40 Recharge") {
        autonomiaM = 208;
        cBateria = 78;
      }

      var pActual = document.getElementById("porc").value;
      pActual = parseFloat(pActual);

      var pfaltante = 100 - pActual;
      var potencia = (tension * corriente) / 1000;
      var potenciaT = potencia * 1000;
      var tTotal = cBateria / potencia;
      var tRestante = (pfaltante * tTotal) / 100;

      var horas = Math.floor(tRestante);
      var minutosDecimal = (tRestante - horas) * 60;
      var minutos = Math.floor(minutosDecimal);
      var segundos = Math.round((minutosDecimal - minutos) * 60);

      var kWh = 779.1;

      var costo = horas * kWh + (minutos * kWh) / 60;
      var costoT = costo.toFixed(2);

      var costoAc = calcularCosto();
      var auto = calcularAutonomia();

      var contenido3Div = document.getElementById("porcentaje");
      contenido3Div.innerHTML = "";

      var nuevoContenido3 = document.createElement("div");

      nuevoContenido3.innerHTML = `<div id="datos">
        <div class="container3">
          <div>
            <div class="circle" style="background-color:grey;">
              <p class="circle-text">Tiempo de carga total: ${horas}h${minutos}m${segundos}s</p>
            </div>
            <div>
              <p>Tiempo desde que inicio la carga:</p>
              <p id="cronometro">00:00:00</p>
              <p>Costo total de carga: $${costoT}</p>
              <p id="costo">${costoAc}</p>
            </div>
          </div>
          <div>
            <div class="circle" style="background-color:grey;">
              <p class="circle-text">Potencia actual: ${potenciaT}W</p>
            </div>
            <div>
              <p>Tensión: ${tension}V</p>
              <p>Corriente: ${corriente}A</p>
            </div>
          </div>
          <div>
            <div class="circle" style="background-color:grey;">
              <p class="circle-text">Temperatura: ${temperatura}°C</p>
            </div>
            <div>
              <p id="autoLLevar">Autonomía total: ${autonomiaM}km</p>
              <p id="autonomia">${auto}</p>
            </div>
          </div>
        </div>
      </div>
      <button id="Boton3" onclick="redireccionar4()">Finalizar</button>`;

      contenido3Div.appendChild(nuevoContenido3);

      var segundos1 = 0;
      var minutos1 = 0;
      var horas1 = 0;

      // Función para actualizar el cronómetro y la página cada segundo
      function actualizarPagina() {
        // Actualizar el cronómetro
        segundos1++;
        if (segundos1 >= 60) {
          segundos1 = 0;
          minutos1++;
          if (minutos1 >= 60) {
            minutos1 = 0;
            horas1++;
          }
        }

        // Formatear los valores de horas, minutos y segundos con dos dígitos
        var segundosFormateados = segundos1 < 10 ? "0" + segundos1 : segundos1;
        var minutosFormateados = minutos1 < 10 ? "0" + minutos1 : minutos1;
        var horasFormateadas = horas1 < 10 ? "0" + horas1 : horas1;

        // Actualizar el elemento HTML con el cronómetro actualizado
        var cronometroElemento = document.getElementById("cronometro");
        cronometroElemento.textContent = horasFormateadas + ":" + minutosFormateados + ":" + segundosFormateados;

        var costoElemento = document.getElementById("costo");
        costoElemento.textContent = "Costo actual carga: $" + calcularCosto();

        var autonomiaElemento = document.getElementById("autonomia");
        autonomiaElemento.textContent = "Autonomía actual: " + calcularAutonomia() + "km";

        // Actualizar la página cada segundo
        setTimeout(actualizarPagina, 1000);
      }

      function calcularCosto() {
        var costo = horas1 * kWh + (minutos1 * kWh) / 60;
        return costo.toFixed(2);
      }

      function calcularAutonomia() {
        var pFinal = pActual + (segundos1 + minutos1 * 60 + horas1 * 3600) / (segundos + minutos * 60 + horas * 3600);
        var autonomia = autonomiaM * (pFinal) / 100;
        return autonomia.toFixed(2);
      }

      actualizarPagina();
}

    //Cambio de página de bateria

    function redireccionar4() {
      function quitarLetras(variable1, variable2) {
        var numeros1 = variable1.replace(/[^\d.-]/g, '');
        var numeros2 = variable2.replace(/[^\d.-]/g, '');
        return [parseFloat(numeros1), parseFloat(numeros2)];
      }

      var obtenidaElemento = document.getElementById("autonomia");
      var obtenidaTexto = obtenidaElemento.innerHTML;

      var obtenida2Elemento = document.getElementById("autoLLevar");
      var obtenida2Texto = obtenida2Elemento.innerHTML;

      var obtenido = quitarLetras(obtenidaTexto, obtenida2Texto)

      var Total = 100 * (obtenido[0] / obtenido[1]);
      var Totalr = Total.toFixed(2);

      var contenidoDiv4 = document.getElementById("datos");
      contenidoDiv4.innerHTML = "";

      var nuevoContenido4 = document.createElement("div");

      nuevoContenido4.innerHTML = `
        <body>
          <div class="battery-container">
            <div class="battery-level" style="--battery-level: ${Totalr}%;"></div>
            <div class="battery-text">${Totalr}%</div>
          </div>
        </body>`;

      contenidoDiv4.appendChild(nuevoContenido4);

      var boton = document.getElementsByTagName("button")[0];
      boton.style.display = "none";
    }



    // Cambia el nivel de carga de la batería (porcentaje)
    function setBatteryLevel(percentage) {
      var batteryLevel = document.querySelector('.battery-level');
      batteryLevel.style.setProperty('--battery-level', percentage + '%');

      var batteryText = document.querySelector('.battery-text');
      batteryText.textContent = percentage + '%';
    }

    // Ejemplo: establece el nivel de carga al %
    setBatteryLevel(Totalr);

  </script>
</body>
</html>
